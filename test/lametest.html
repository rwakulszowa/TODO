<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="../build/splendid.js"></script>
<script src="https://rawgit.com/rwakulszowa/d3-mesh/v0.3.1/examples/d3-mesh.js"></script>
<style>
.link {
  fill: none;
  stroke: #555;
}
path {
  stroke-linecap: round;
  stroke-width: 2px;
}
text {
  fill: white;  
}
</style>
<body>
</body>
<script>

//A super-lame "test", just temporary
function randInt(limit, offset) {
    offset = offset || 0;
    limit = limit || 25;
    return Math.floor(Math.random() * (limit - offset) + offset);
}

function randomPick(options) {
    return options[randInt(options.length)];
}

function randomGraph() {
    const nodeCount = randInt(25, 4);
    const edgeCount = randInt(25);
    const nodes = [...Array(nodeCount).keys()].map(d => ( { id: d } ));
    var links = [];
    for (var i = 0; i < edgeCount; ++i) {
        const source = randInt(nodeCount);
        const target = randInt(nodeCount);
        if (source != target) {
            links.push({ source, target });
        }
    }
    return { nodes, links };
}

function randomTree(depth) {
    depth = depth || 0;
    var leaf = depth != 0 && (depth == 4 || randInt(2) == 0);

    if (leaf) {
        return {
            value: randInt(25)
        };
    } else {
        return {
            value: randInt(25),
            children: Array(randInt(4, 1)).fill(0).map(_ => randomTree(depth + 1))
        };
    }
}

function randomNumArray() {
    return Array(49).fill(25).map(randInt);
}

function randomXYZArray(keyRanges) {
    keyRanges = keyRanges || [25, 25, 4];
    return Array(100).fill(25).map(_ => randomXYZObject(keyRanges));
}

function randomXYZObject(keyRanges) {
    const keys = "xyzwu".slice(0, keyRanges.length);
    var ans = {};
    for (var i in keys) {
        const key = keys[i];
        const range = keyRanges[i];
        ans[key] = randInt(range);
    }
    return ans;
}

function randomSimpleThing() {
    const options = [randomGraph, randomNumArray, randomTree, randomXYZArray];
    return randomPick(options)();
}

function randomAnyArray() {
    return Array(4).fill(0).map(randomSimpleThing);
}

function force(data, label) {
    return { data: data, SplendidLabel: label };
}

var data = {
    "Graph": randomGraph(),
    "NumericArray": randomNumArray(),
    "Tree": randomTree(),
    "XYZArray": randomXYZArray(),
    "XYZWArray": randomXYZArray([25, 25, 4, 4]),
    "ObjectTree": { a: randomSimpleThing(), b: { c: randomSimpleThing(), e: randomSimpleThing() } },
    "AnyArray": randomAnyArray()
};

var forced = Object.keys(data).map(
    key => force(data[key], key));
splendid.show(forced);
</script>
