<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="../build/splendid.js"></script>
<script src="https://rawgit.com/rwakulszowa/d3-mesh/v0.3.1/examples/d3-mesh.js"></script>
<style>
.bar {
    fill: grey
}
</style>
<div id="container"></div>
<script>

var size = { x: 480, y: 320 };

var container = d3.select("body")
    	  .append("svg")
	    .attr("width", size.x)
	    .attr("height", size.y);


function mergeSort(data) {
    var ans = {};
    ans.input = data.slice();  // deep copy

    function merge(a, b) {
        acc = [];
        while(true) {
            if (a.length == 0) {
                Array.prototype.push.apply(acc, b);
                return acc;
            } else if (b.length == 0) {
                Array.prototype.push.apply(acc, a);
                return acc;
            } else {
                acc.push(a[0] < b[0] ? a.shift() : b.shift());
            }
        }
    }

    if (data.length <= 1) {
        ans.children = [];
        ans.output = data.slice();
    } else {
        var half = data.splice(
            Math.floor(data.length / 2)); // the other half stays in 'data'

        var aSorted = mergeSort(data),
            bSorted = mergeSort(half);

        var merged = merge(aSorted.output, bSorted.output);

        ans.children = [aSorted, bSorted];
        ans.output = merged;
    }

    return ans;

}

var m = d3.mesh();
m.x().domain([0, size.x]);
m.y().domain([0, size.y]);
m.data([[ mergeSort([1,5,2,4,8,6,17,9]) ]]);

var plot = container.selectAll("g")
    .data(m.flat())
    .enter().append("g");

new splendid.painter.Root(plot).paint();

</script>
</head>

